<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The SW6 Club</title>
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon" href="/favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Sora:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app-shell">
      <header class="hero">
        <div class="hero-main">
          <h1>The SW6 Club</h1>
          <p>Your completely unofficial Chelsea score predictor.</p>
          <div class="how-strip">
            <p><strong>1.</strong> Pick score and scorers</p>
            <p><strong>2.</strong> Submit before lock</p>
            <p><strong>3.</strong> Climb league tables</p>
          </div>
        </div>
        <p id="deadline-countdown" class="hero-deadline"></p>
      </header>

      <section class="panel auth-thin" id="auth-panel">
        <p class="section-kicker">Account</p>
        <form id="login-form" class="auth-bar-form">
          <div id="auth-login-fields" class="auth-login-fields">
            <input id="login-email-input" type="email" placeholder="Email" required />
            <input id="login-password-input" type="password" minlength="6" placeholder="Password" required />
          </div>
          <button id="login-btn" type="submit">Log In</button>
          <button id="logout-inline-btn" type="button" class="danger-btn hidden">Log Out</button>
          <a class="ghost-link" href="signup.html">Create account</a>
        </form>
        <p id="session-status" class="status auth-inline-status">Not signed in.</p>
      </section>

      <section class="panel prediction-primary">
        <p class="section-kicker">Predict</p>
        <h2 class="fixtures-title">Next Game</h2>
        <ul id="fixtures-list" class="fixtures-list"></ul>
      </section>

      <section class="panel overview-panel">
        <p class="section-kicker">Track</p>
        <details id="league-panel" class="collapse-card" open>
          <summary>Your Leagues</summary>
          <div class="collapse-body">
            <div class="league-forms">
              <form id="create-league-form" class="mini-form">
                <h3>Create League</h3>
                <label>
                  League name
                  <input id="league-name-input" type="text" required />
                </label>
                <button type="submit">Create</button>
              </form>

              <form id="join-league-form" class="mini-form">
                <h3>Join League</h3>
                <label>
                  League code
                  <input id="join-code-input" type="text" placeholder="e.g., SW6A7KQ9" required />
                </label>
                <button type="submit">Join</button>
              </form>
            </div>

            <div class="league-meta">
              <label>
                Active league
                <select id="league-select"></select>
              </label>
              <button id="copy-code-btn" type="button" class="ghost-btn">Copy League Code</button>
              <button id="copy-invite-link-btn" type="button" class="ghost-btn">Copy Invite Link</button>
            </div>

            <div class="dashboard-grid">
              <article class="subpanel">
                <h3>Standings</h3>
                <ul id="leaderboard" class="leaderboard"></ul>
              </article>
              <article class="subpanel">
                <h3>League Home</h3>
                <ul id="league-members-list" class="leaderboard"></ul>
                <ul id="league-results-list" class="past-games-list"></ul>
              </article>
            </div>
          </div>
        </details>

        <details id="global-overview-panel" class="collapse-card">
          <summary>Global Leaderboard</summary>
          <div class="collapse-body">
          <h2>Global Leaderboard (Top 10)</h2>
          <ul id="overall-leaderboard" class="leaderboard"></ul>
          <p id="overall-leaderboard-status" class="status no-margin"></p>
          </div>
        </details>

        <details id="past-overview-panel" class="collapse-card">
          <summary>Past Games</summary>
          <div class="collapse-body">
          <h2>Past Games</h2>
          <ul id="past-games-list" class="past-games-list"></ul>
          <p id="past-games-status" class="status no-margin"></p>
          </div>
        </details>

        <details id="rules-overview-panel" class="collapse-card">
          <summary>Rules</summary>
          <div class="collapse-body">
          <h2>Game Rules</h2>
          <ul class="rules-list">
            <li><strong>Who can predict:</strong> Anyone logged in can submit a prediction.</li>
            <li><strong>Which fixture:</strong> You can only predict the next Chelsea fixture.</li>
            <li><strong>Deadline:</strong> Predictions lock 90 minutes before kick-off.</li>
            <li><strong>Chelsea goals:</strong> Auto-calculated from selected Chelsea goalscorers.</li>
            <li><strong>First scorer:</strong> Must be selected from your chosen goalscorers when Chelsea are predicted to score.</li>
          </ul>
          <h3>Scoring</h3>
          <ul class="rules-list">
            <li>Exact score: <strong>+5</strong></li>
            <li>Correct result (win/draw/loss), but not exact: <strong>+2</strong></li>
            <li>Correct Chelsea goals: <strong>+1</strong></li>
            <li>Correct opponent goals: <strong>+1</strong></li>
            <li>Each correct Chelsea goalscorer (no cap): <strong>+1 each</strong></li>
            <li>Correct first Chelsea scorer: <strong>+2</strong></li>
            <li>Perfect bonus (exact score + correct first scorer): <strong>+1</strong></li>
            <li>No prediction before deadline: <strong>0</strong></li>
          </ul>
          </div>
        </details>
      </section>
    </main>

    <footer class="site-footer">
      <p>Unofficial fan project. Not affiliated with Chelsea FC.</p>
      <p id="data-source-line">Data source: Chelsea official fixtures feed + ESPN stat snapshot.</p>
    </footer>

    <template id="fixture-template">
      <li class="fixture-item">
        <div class="next-fixture-card">
          <p class="mini-title">Next Fixture</p>
          <div class="fixture-head">
            <p class="fixture-title"></p>
            <span class="status-badge"></span>
          </div>
          <p class="fixture-meta"></p>
          <p class="lock-line"></p>
        </div>
        <div class="fixture-body">
          <form class="prediction-form prediction-card">
            <p class="mini-title">Your Prediction</p>
            <div class="scoreboard-picker">
              <div class="score-team">
                <p class="score-team-name pred-opponent-name">Opponent</p>
                <div class="score-stepper">
                  <button type="button" class="score-minus score-minus-opponent">-</button>
                  <span class="score-value score-value-opponent">0</span>
                  <button type="button" class="score-plus score-plus-opponent">+</button>
                </div>
              </div>
              <p class="score-separator">:</p>
              <div class="score-team">
                <p class="score-team-name">Chelsea</p>
                <div class="score-stepper">
                  <button type="button" class="score-minus score-minus-chelsea">-</button>
                  <span class="score-value score-value-chelsea">0</span>
                  <button type="button" class="score-plus score-plus-chelsea">+</button>
                </div>
              </div>
            </div>
            <input class="pred-chelsea" type="number" min="0" required hidden />
            <input class="pred-opponent" type="number" min="0" required hidden />
            <div class="goalscorer-picker">
              <p class="mini-title no-margin">Select Goalscorers</p>
              <p class="scorer-helper">Scorers chosen should match Chelsea goals. We auto-total Chelsea goals from your picks.</p>
              <div class="scorer-fast-tools">
                <input class="scorer-search" type="search" placeholder="Search players..." />
                <button type="button" class="ghost-btn clear-scorers-btn">Clear all</button>
                <button type="button" class="ghost-btn undo-scorer-btn">Undo last</button>
                <button type="button" class="ghost-btn repeat-last-btn">Repeat last prediction</button>
              </div>
              <div class="quick-picks">
                <p class="quick-picks-title">Quick picks</p>
                <div class="quick-picks-wrap"></div>
              </div>
              <p class="prediction-ack hidden" aria-live="polite"></p>
              <p class="status no-margin">Selected: <span class="selected-scorer-value">None</span></p>
              <input class="pred-scorer" type="text" readonly placeholder="Pick players below" />
              <ul class="selected-scorer-list"></ul>
              <label>
                First Chelsea goalscorer
                <select class="pred-first-scorer" required>
                  <option value="">Select from chosen scorers</option>
                </select>
              </label>
              <div class="scorer-group">
                <p class="scorer-group-title">Chelsea Registered Players by Position</p>
                <div class="player-chip-wrap player-chip-wrap-chelsea"></div>
              </div>
            </div>
            <button type="submit">Submit prediction</button>
            <div class="auth-cta-row hidden">
              <a class="ghost-link create-account-cta" href="signup.html">Create account to submit</a>
              <button type="button" class="ghost-btn login-cta-btn">Log in</button>
            </div>
          </form>
        </div>

      </li>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js"></script>
  </body>
</html>
